Extracting Features from Relational Data with Featuretools
292
2.	
Let’s load the dataset described in the Technical requirements section:
df = pd.read_csv(
    «retail.csv», parse_dates=[«invoice_date»])
3.	
Let’s set up an entity set:
es = ft.EntitySet(id="data")
4.	
Let’s add the DataFrame to the entity set:
es = es.add_dataframe(
    dataframe=df,
    dataframe_name=»data»,
    index="rows",
    make_index=True,
    time_index=»invoice_date»,
    logical_types={«customer_id»: Categorical},
)
5.	
Let’s create a new DataFrame with a relationship to the DataFrame from step 4:
es.normalize_dataframe(
    base_dataframe_name=»data»,
    new_dataframe_name=»invoices»,
    index="invoice",
    copy_columns=[«customer_id»],
)
Note
For more details about steps 4 and 5, visit the Setting up an entity set and creating features 
automatically recipe.
6.	
Let’s create a primitive that returns a Boolean vector indicating if the date coincides with a UK 
bank holiday (that is, a non-working day):
is_bank_hol = IsFederalHoliday(country="UK")
Note
When setting up the primitive to determine bank holidays, it is important to choose the right 
country. For a list of supported countries, visit https://github.com/dr-prodigy/
python-holidays#available-countries.
