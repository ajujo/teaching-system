Performing one-hot encoding of frequent categories
53
2.	
Let’s load the Credit Approval dataset and divide it into train and test sets:
data = pd.read_csv("credit_approval_uci.csv")
X_train, X_test, y_train, y_test = train_test_split(
    data.drop(labels=["target"], axis=1),
    data["target"],
    test_size=0.3,
    random_state=0,
)
Note
The most frequent categories need to be determined in the train set. This is to avoid data leakage.
3.	
Let’s inspect the unique categories of the A6 variable:
X_train["A6"].unique()
The unique values of A6 are displayed in the following output:
array(['c', 'q', 'w', 'ff', 'm', 'i', 'e', 'cc', 'x', 'd', 'k', 
'j', 'Missing, 'aa', 'r'], dtype=object)
4.	
Let’s count the number of observations per category of A6, sort them in decreasing order, and 
then display the five most frequent categories:
X_train["A6"].value_counts().sort_values(
    ascending=False).head(5)
We can see the five most frequent categories and the number of observations per category in 
the following output:
A6
c      93
q      56
w      48
i      41
ff     38
Name: count, dtype: int64
5.	
Now, let’s capture the most frequent categories of A6 in a list by using the code in Step 4 inside 
a list comprehension:
top_5 = [x for x in X_train[
      " A6"].value_counts().sort_values(
          ascending=False).head(5).index
]
