Creating features with aggregation primitives
301
2.
Let's load the dataset described in the Technical requirements section:
df = pd.read_csv(
    «retail.csv», parse_dates=[«invoice_date»])
3.
Let's set up an entity set:
es = ft.EntitySet(id="data")
4.
Let's add the DataFrame to the entity set, highlighting that the description variable is a
text variable, customer_id is categorical, and invoice_date is a datetime feature:
es = es.add_dataframe(
    dataframe=df,
    dataframe_name=»data»,
    index="rows",
    make_index=True,
    time_index=»invoice_date»,
    logical_types={
        «customer_id»: Categorical,
        «description»: NaturalLanguage,
    }
)
5.
Let's create a new DataFrame with a relationship to the DataFrame from step 4:
es.normalize_dataframe(
    base_dataframe_name=»data»,
    new_dataframe_name=»invoices»,
    index="invoice",
    copy_columns=[«customer_id»],
)
6.
Now, we add the second relationship, which is between customers and invoices. To do this, we
indicate the base DataFrame, which we called invoices in step 5, we give the new DataFrame
a name, customers, and we add a unique customer identifier:
es.normalize_dataframe(
    base_dataframe_name=»invoices»,
    new_dataframe_name=»customers»,
    index=»customer_id»,
)
Note
For more details about steps 4 to 5, visit the Setting up an entity set and creating features
automatically recipe.
