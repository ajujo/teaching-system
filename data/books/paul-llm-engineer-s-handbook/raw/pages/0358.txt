Chapter 9
327
Finally, we define the QueryExpansionTemplate class, which constructs the prompt used for 
query expansion. The class and other prompt templates can be accessed at https://github.com/
PacktPublishing/LLM-Engineers-Handbook/blob/main/llm_engineering/application/rag/
prompt_templates.py:
from langchain.prompts import PromptTemplate
from .base import PromptTemplateFactory
class QueryExpansionTemplate(PromptTemplateFactory):
    prompt: str = """You are an AI language model assistant. Your task is 
to generate {expand_to_n}
    different versions of the given user question to retrieve relevant 
documents from a vector
    database. By generating multiple perspectives on the user question, 
your goal is to help
    the user overcome some of the limitations of the distance-based 
similarity search.
    Provide these alternative questions separated by '{separator}'.
    Original question: {question}"""
    @property
    def separator(self) -> str:
        return "#next-question#"
    def create_template(self, expand_to_n: int) -> PromptTemplate:
        return PromptTemplate(
            template=self.prompt,
            input_variables=["question"],
            partial_variables={
                "separator": self.separator,
                "expand_to_n": expand_to_n,
            },
        )
This class defines a prompt instructing the language model to generate multiple versions of 
the userâ€™s question. It uses placeholders like {expand_to_n}, {separator}, and {question} to 
customize the prompt. 
